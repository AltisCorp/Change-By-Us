{% extends "./partials/base.html" %}

{% block title %}
Change by Us - CMS Content
{% endblock title %}

{% block continent %}

<div class='continent cms cms-content'>

	<div class='headlands clearfix'>
		<ul class="tabs">
			<li class="tab featured-projects"><a href="#featuredprojects">Featured Projects</a></li>
			<li class="tab warning-list"><a href="#warninglist">Warning List</a></li>
			<li class="tab pending-resources"><a href="#pendingresources">Pending Resources</a></li>
			<li class="tab metrics"><a href="#sitemetrics">Metrics</a></li>
		</ul>
	</div><!-- end .headlands -->

	<div class='midlands merlin clearfix'>
		<div id="featured-projects" class="step view">
			<div class="top-tier clearfix">
				<div class="west">
					<h2>Featured Projects are displayed on the board located on the homepage of the site.</h2>
				</div>
				<div class="east">
					<p><strong>Note:</strong> only five projects can be featured on the homepage at a time. To add a different project, you can <a href="/search?terms=#projects">find some projects to feature</a>.</p>
				</div>
			</div>
			<div class="main-tier">
				<table class="featured-projects-table">
					<tbody>
						{% for project in d.template_data.featured_projects.data %}
							<tr class="{% if loop.index is odd %}alt{% endif %}">
								<th class="featured-project-header" scope="row">
									<h3 class="serif">{{ project.title }}</h3>
								</th>
								<td class="info-breakdown">
									<ul>
										<li><span class="counter">{{ project.num_members }}</span> Members</li>
										<li><span class="counter">{{ project.num_ideas }}</span> Ideas</li>
										<li><span class="counter">{{ project.num_resources }}</span> Resources</li>
										<li><span class="counter">{{ project.num_endorsements }}</span> Endorsements</li>
									</ul>
								</td>
								<td class="info-description serif">
									<p>{{ project.description }}</p>
								</td>
								<td class="info-meta">
									Featured since <br /><strong>{{ project.featured_datetime }}</strong><br />by <strong>{{ project.owner.name }}</strong>
								</td>
								<td class="control-delete">
									<a href="#deleteProject,{{ project.project_id }}" class="delete"><span>Delete</span></a>
								</td>
							</tr>
						{% endfor %}
					</tbody>
				</table>
			</div>
		</div>
		
		
		<div id="warning-list" class="step view" style="display:none">
			<div class="west sidebar">
				<div class="box flagged-content-filters">
					<div class="hd">
						<h2>Flagged Content</h2>
					</div>
					<div class="bd">
						<a href="#all" class="sidebar-item all active"><span>All</span></a>
						<a href="#ideas" class="sidebar-item ideas"><span>Ideas</span></a>
						<a href="#projects" class="sidebar-item projects"><span>Projects</span></a>
						<a href="#project-posts" class="sidebar-item project-posts"><span>Project Posts</span></a>
						<a href="#project-goals" class="sidebar-item project-goals"><span>Project Goals</span></a>
						<a href="#links" class="sidebar-item links"><span>Links</span></a>
					</div>
					<div class="ft">
						<p>Content is flagged according to the <q>Graylist</q> of questionable language.</p><br />
						<p>View and Edit the Graylist under<br />Admin Settings &rarr; Blacklist</p>
					</div>
				</div>
			</div>
			<div class="east">
				
				
				<!-- <div class="box">
					<div class="hd clearfix">
						<div class="pagination-controls">
							<span class="control">
								<a class="prev" href="#"><span class="sm-arrow-back light"></span><span>Previous</span></a>
								<a class="next" href="#"><span>Next</span><span class="sm-arrow-forward light"></span></a>
							</span>
						</div>
					</div>
					<div class="bd">
						<ul class="items warning-list-stack">
							<li class="item-box ideas all">
								<div class="hd">
									<div class="controls">
										<a href="#" class="control-ok">OK</a>
										<a href="#" class="control-delete">Delete</a>
									</div>
									<div class="info">
										<span class="name">Lorem Lastname</span> in
										<span class="title serif">Project Name</span>
										<span class="time"><strong>12:43pm</strong> on <strong>04.03.2011</strong></span>
									</div>
								</div>
								<div class="bd serif">
									<blockquote>
										<p>Idea. Iusto dolore eorum claritatem exerci consuetudium. Qui est processus lectores modo humanitatis. Aliquam non dolor eodem lectorum duis.</p>
									</blockquote>
								</div>
							</li>
						</ul>
					</div> -->
					
				<div class="box active-admins">
					<div class="hd clearfix">
						<div class="pagination-controls">
							<span class="control">
								<a class="prev warning-carousel-prev" href="#"><span class="sm-arrow-back light"></span><span>Previous</span></a>
								<a class="next warning-carousel-next" href="#"><span>Next</span><span class="sm-arrow-forward light"></span></a>
							</span>
						</div>
					</div>
					<div class="bd">
						<div class="carousel warning">
							<div class="scrollable">
								<ul class="items">
									
									<li class='loaded'>
										<ul class="items warning-list-stack">
											<li class="item-box ideas all" >
												<div class="hd">
													<div class="controls">
														<a href="#" class="control-ok">OK</a>
														<a href="#" class="control-delete">Delete</a>
													</div>
													<div class="info">
														<span class="name">Lorem Lastname</span> in
														<span class="title serif">Project Name</span>
														<span class="time"><strong>12:43pm</strong> on <strong>04.03.2011</strong></span>
													</div>
												</div>
												<div class="bd serif">
													<blockquote>
														<p>Idea. Iusto dolore eorum claritatem exerci consuetudium. Qui est processus lectores modo humanitatis. Aliquam non dolor eodem lectorum duis.</p>
													</blockquote>
												</div>
											</li>
										</ul>
									</li>
									
									<li>
										<table class="active-admins-table">
											<tbody>
												<tr>
													<td><p>Loading...</p></td>
												</tr>
											</tbody>
										</table>
									</li>
									
								</ul>
							</div>
						</div>
					</div>
					<div class="ft">
						<div class="pagination-controls">
							<span class="control">
								<a class="prev warning-carousel-prev" href="#"><span class="sm-arrow-back light"></span><span>Previous</span></a>
								<a class="next warning-carousel-next" href="#"><span>Next</span><span class="sm-arrow-forward light"></span></a>
							</span>
						</div>
					</div>
					
				</div>
			</div>
		</div>
		
		
		<div id="pending-resources" class="step view" style="display:none">
			<div class="west">
				<div class="box">
					<div class="bd">
						<p>These resources have been submitted to the site and await approval.</p><br />
						<p>Review and approve them to include them on the site.</p>
					</div>
				</div>
			</div>
			<div class="east">
				<div class="hd clearfix">
					<div class="pagination-controls">
						<span class="control">
							<a class="prev" href="#"><span class="sm-arrow-back light"></span><span>Previous</span></a>
							<a class="next" href="#"><span>Next</span><span class="sm-arrow-forward light"></span></a>
						</span>
					</div>
				</div>
				<div class="bd">
					<ul class="items pending-resources-stack">
						<li class="item-box clearfix">
							<div class="hd">
								<div class="controls">
									<a href="#" class="control-approve">Approve</a>
									<a href="#" class="control-delete">Delete</a>
								</div>
							</div>
							<div class="bd">
								<div class="west">
									<h3 class="serif">Resource Name</h3>
									<p class="serif"><a href="">www.resourcewebsite.org</a><br/> Given Location</p>
									<div class="tags">
										<h4>Tags</h4>
										<span class="serif">lorem, ipsum, sit, eros</span>
									</div>
								</div>
								<div class="mission">
									<h4>Mission</h4>
									<span class="serif"><p>Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Vestibulum tortor quam, feugiat vitae, ultricies eget, tempor sit amet, ante. Donec eu libero sit amet quam egestas semper. Aenean ultricies mi vitae est. Mauris placerat eleifend leo. Quisque sit amet est et sapien ullamcorper pharetra. Vestibulum erat wisi, condimentum sed, commodo vitae, ornare sit amet, wisi. Aenean fermentum, elit eget tincidunt condimentum, eros ipsum rutrum orci.</p></span>
								</div>
							</div>
						</li>
					</ul>
				</div>
			</div>
		</div>
		
		
		<div id="metrics" class="step view" style="display:none">
			<div class="metrics-header clearfix">
				<div class="west">
					<h2>Overall <span class="unbold">Metrics</span></h2>
				</div>
				<div class="overall-stats">
					<ul class="breakdown clearfix">
						<li>
							<span class="counter">120,228</span>
							Users
						</li>
						<li>
							<span class="counter">732</span>
							Projects
						</li>
						<li>
							<span class="counter">2,034</span>
							Ideas
						</li>
						<li>
							<span class="counter">120</span>
							Resources
						</li>
					</ul>
					<div class="averages">
						Average of <span class="counter">28</span> members per project <span class="separator">|</span>
						Average of <span class="counter">55</span> ideas submitted per day
					</div>
				</div>
			</div>
			<div class="box metrics-section metrics-keywords">
				<div class="hd clearfix">
					<h2><span class="unbold">Top</span> Keywords<span class="counter">135 Total</span></h2>
					<a href="#" class="download-button download-csv rounded-button small">Download (.csv)</a>
				</div>
				<div class="bd">
					<ul class="keyword-list clearfix">
						<li>
							<span class="stats">
								<span><span class="counter">210</span> Projects</span>
								<span><span class="counter">34</span> Resources</span>
							</span>
							<h3><span class="serif">trees</span> <span class="counter">258</span></h3>
						</li>
						<li>
							<span class="stats">
								<span><span class="counter">210</span> Projects</span>
								<span><span class="counter">34</span> Resources</span>
							</span>
							<h3><span class="serif">solar</span> <span class="counter">258</span></h3>
						</li>
						<li>
							<span class="stats">
								<span><span class="counter">210</span> Projects</span>
								<span><span class="counter">34</span> Resources</span>
							</span>
							<h3><span class="serif">recycling</span> <span class="counter">258</span></h3>
						</li>
						<li>
							<span class="stats">
								<span><span class="counter">210</span> Projects</span>
								<span><span class="counter">34</span> Resources</span>
							</span>
							<h3><span class="serif">green</span> <span class="counter">258</span></h3>
						</li>
						<li>
							<span class="stats">
								<span><span class="counter">210</span> Projects</span>
								<span><span class="counter">34</span> Resources</span>
							</span>
							<h3><span class="serif">bicycle</span> <span class="counter">258</span></h3>
						</li>
						<li>
							<span class="stats">
								<span><span class="counter">210</span> Projects</span>
								<span><span class="counter">34</span> Resources</span>
							</span>
							<h3><span class="serif">water</span> <span class="counter">258</span></h3>
						</li>
					</ul>
				</div>
			</div>
			<div class="box metrics-section metrics-projects">
				<div class="hd clearfix">
					<h2>Project <span class="unbold">Metrics</span></h2>
					<a href="#" class="download-button download-csv rounded-button small">Download (.csv)</a>
				</div>
				<div class="bd">
					<p>Contains the number of: <strong>Members</strong>, <strong>Ideas</strong>, <strong>Resources</strong>, <strong>Endorsements</strong> and <strong>tags</strong> for all projects. (organized alphabetically by name)</p>
				</div>
			</div>
			<div class="box metrics-section metrics-user">
				<div class="hd clearfix">
					<h2>User <span class="unbold">Metrics</span></h2>
					<a href="#" class="download-button download-csv rounded-button small">Download (.csv)</a>
				</div>
				<div class="bd">
					<p>Contains: <strong>name</strong>, <strong>email</strong>, <strong>date joined</strong>, <strong>projects joined</strong>, and <strong>date</strong> <br />for each user (organized alphabetically by user name)</p>
				</div>
			</div>
			<div class="box metrics-section metrics-location">
				<div class="hd clearfix">
					<h2>Location <span class="unbold">Metrics</span></h2>
					<a href="#" class="download-button download-csv rounded-button small">Download (.csv)</a>
				</div>
				<div class="bd">
					<p>Contains the number of: <strong>Projects</strong>, <strong>Ideas</strong>, and <strong>Resources</strong> <br />for each neighborhood. (organized by borough)</p>
				</div>
			</div>
		</div>
	</div>

	<div class='foothills'>

	</div>
	

</div><!-- end .continent.cms-content -->
{% endblock continent %}




{% block page_js %}
<script type="text/javascript">
	app_page.features.push(function(app){
		tc.util.log('Give A Minute: Content');
		
		app.components.merlin = new tc.merlin(app,{
			dom:tc.jQ('.merlin'),
			first_step:'featuredprojects',
			steps:{
				'featuredprojects':{
					selector:'#featured-projects',
					init:function(merlin,dom){
						tc.jQ('.headlands .tabs li').removeClass('active');
						tc.jQ('.headlands .tabs li.featured-projects').addClass('active');
					}
				},
				'warninglist':{
					selector:'#warning-list',
					init:function(merlin,dom){
						tc.jQ('.headlands .tabs li').removeClass('active');
						tc.jQ('.headlands .tabs li.warning-list').addClass('active');
						build_carousel(merlin.app);
					}
				},
				'pendingresources':{
					selector:'#pending-resources',
					init:function(merlin,dom){
						tc.jQ('.headlands .tabs li').removeClass('active');
						tc.jQ('.headlands .tabs li.pending-resources').addClass('active');
					}
				},
				'sitemetrics':{
					selector:'#metrics',
					init:function(merlin,dom){
						tc.jQ('.headlands .tabs li').removeClass('active');
						tc.jQ('.headlands .tabs li.metrics').addClass('active');
					}
				}
			}
		});
		
		
		function build_carousel(app){
			var data, fn;
			
			data = {
				current_section:null,
				current_page:null,
				n_to_fetch: 10,
				offset:0
			};
			
			fn = {
				
			};
			
			app.components.warning_pagination = new tc.carousel({
				element: tc.jQ(".warning.carousel"),
				next_button: tc.jQ('.tc.jQ-carousel-next'),
				prev_button: tc.jQ('.tc.jQ-carousel-prev')
			});
			
			tc.util.dump(app.components.warning_pagination);
			
			//merlin.current_step.runtime_data.n_to_fetch = 10;
			//merlin.current_step.runtime_data.offset = merlin.current_step.components.admins_pagination.carousel.getItems().first().find('tr').length;
			if(!app.components.warning_pagination){
				return;
			}
			app.components.warning_pagination.carousel.getRoot().bind('onSeek', {app:app,data:data}, function(e,d){
				e.data.data.current_page = e.data.app.components.warning_pagination.carousel.getItems().eq(e.data.app.components.warning_pagination.carousel.getIndex());
				if(!e.data.data.current_page.hasClass('loaded')){
					e.data.data.current_page.addClass('loaded');
					tc.jQ.ajax({
						type:"GET",
						url:"/admin/users",
						data:{
							n_messages: e.data.data.n_to_fetch,
							offset: e.data.data.offset
						},
						context:e.data.app,
						dataType:"text",
						success: function(data, ts, xhr) {
							var d, temptbody, temprow;
							try {
								d = tc.jQ.parseJSON(data);
							} catch(e) {
								tc.util.log("/admin/users: json parsing error", "warn");
								return;
							}
							if(!d.length){
								this.current_step.runtime_data.current_page.remove();
								return;
							}
							if(d.length == this.current_step.runtime_data.n_to_fetch){
								this.current_step.components.admins_pagination.carousel.addItem('<li>\
									<table class="active-admins-table">\
										<tbody>\
											<tr>\
												<td class="spinner-message clearfix">\
													<p class="west">Saving Blacklist...</p>\
													<img class="loading" src="/static/images/loader32x32.gif" />\
												</td>\
											</tr>\
										</tbody>\
									</table>\
								</li>');
							}
							temptbody = tc.jQ('<tbody></tbody>');
							for(i in d){
								//temprow = this.current_step.runtime_data.tr_element.clone();
								//this.current_step.runtime_data.current_page.find('tbody').replaceWith(temptbody);
							}
						}
					});
				}
			});
		}
		
		
		//var warningListSidebarLinks = tc.jQ('#warning-list .sidebar-item');
		//var warningListItems = tc.jQ('#warning-list li.item-box');
		//
		//function warningListFilter(filterSelector) {
		//	warningListSidebarLinks.filter(filterSelector).click(function() {
		//		warningListItems.hide();
		//		warningListItems.filter(filterSelector).show().removeClass('alt').filter(':odd').addClass('alt');
		//		warningListSidebarLinks.removeClass('active');
		//		tc.jQ(this).addClass('active');
		//	});
		//};
		//
		//warningListFilter('.all');
		//warningListFilter('.ideas');
		//warningListFilter('.projects');
		//warningListFilter('.project-posts');
		//warningListFilter('.project-goals');
		//warningListFilter('.links');
		
		
		
		tc.jQ('.adminbar li.content').addClass('active');
		
	});
</script>
{% endblock page_js %}