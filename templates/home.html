{% extends "./partials/base.html" %}

{% block title %}
Give A Minute - Home
{% endblock title %}

{% block continent %}
<div class='continent home'>
	<div class='headlands'>
		<span class="hey"><span>Hey NYC!</span></span>
		<div class='splash-container'>
			<div class='splash-background'></div>
			<div class='splash merlin'>
				<div class="splash-inner first">
					<!-- post your idea step -->
					<div class='top-pane start'>
						
						<div class="console">
							<span class="start console-message"><span></span>How can we green our neighborhoods?</span>
							<span class="more-info after-idea-message" style='display:none;'>Thanks for your idea<br /><span class="sm">We just need a little more information</span></span>
							<span class="thanks after-idea-message" style='display:none;'>Thanks for your idea<br /><span class="sm">Please wait while we process your idea!</span></span>
						</div>
						
						<!-- <div class="console">
							
						</div>
						
						<div class="console">
							
						</div> -->
						
						<div class="step-one step-two step">
							<div class="idea-input idea-input-one">
								<div class="primary-action">
									<a class="ca-btn" href="#">
										<span>Post</span>
									</a>
								</div>
								<div class="oops" style="display:none;">
									<span>Oops! Please correct the fields marked in red.</span>
								</div>
								<div class='idea-input-inner-wrapper'>
									<!--<label>What's your idea?</label>-->
									<textarea class='idea'></textarea>
									<div class="helpers">
										<a href="/about">What is this?</a>
										<a href="#whos-listening">Who's Listening</a>
									</div>
								</div>
							</div>
						
							<div class="info-input" style='display:none;'>
								<div class="west">
									<div>
										<span class="col-head">What's your e-mail?</span>
										<input value='Please enter your e-mail address' type='text' name='email' id='email' class='email'/>
										<div class="email-info">
											<p class="email-error">Please enter a valid email address</p>
											<p>We will never send spam or sell your e-mail address.</p>
											<p><em>See our <a href="/tou" class='toc-link'>privacy policy</a> for more details.</em></p>
										</div>
									</div>
								</div>
								<div class="east">
									<span class="col-head">Where is your idea for?</span>
									<div class="row row-1 clearfix">
										<input type='radio' name='location-check' id='location-city' class='location-city location-group'/>
										<label class="location-city-label" for='location-city'>It's for the whole city</a></label>
									</div>
									<div class="row row-2 clearfix">
										<input type='radio' name='location-check' id='location-hood' class='location-hood location-group'/>
										<label class="location-hood-label" for='location-hood'>It's about a neighborhood or borough</a></label>
									</div>
									<div class="row row-3 clearfix">
										<input value='Start typing neighboorhood or borough...' type='text' name='location-hood-enter' id='location-hood-enter' class='location-hood-enter location-group'/>
										<div class="location-hood-list">
											<ul>
												<li><strong>So</strong>Ho</li>
												<li><strong>So</strong>uth Bronx</li>
											</ul>
										</div>
										<span class="error">Please try entering a neighborhood name, or a nearby borough.</span>
									</div>
								</div>
							</div>
						</div><!--end .top-pane.step-two-->
				
						<div class="step idea-processing" style="display:none"></div>
					</div>
					
					<div class="projects-pane">
						<div class="projects-pane-hd">
							<h2><span class="text">Featured Projects</span><a class="ca-btn" href="/search"><span>See all projects</span></a></h2>
						</div>
						<div class="project-cards">
							<div class="membrane">
								<div class="box area1 grouping">
									<div class="hd">
										<h3>{{ d.template_data.all_ideas.data[0].title }}</h3>
									</div>
									<div class="bd">
										{% for idea in d.template_data.all_ideas.data[0].ideas %}
											<div class="small-note"><span><cite class="note-meta-hd"><strong>{{ idea.f_name ~ " " ~ idea.l_name }}</strong> says &mdash;</cite><blockquote><p>{{ idea.text|truncate(180) }}</p></blockquote></span></div>
										{% endfor %}
									</div>
								</div>
								<div class="box area2 grouping">
									<div class="hd">
										<h3>{{ d.template_data.all_ideas.data[1].title }}</h3>
										<div class="endorser-thumb">
											<img src="http://placehold.it/30x30" alt="" class="endorser-photo" />
											<span class="overlay-tag"></span>
										</div>
									</div>
									<div class="bd">
										{% for idea in d.template_data.all_ideas.data[1].ideas %}
											<div class="small-note"><span><cite class="note-meta-hd"><strong>{{ idea.f_name ~ " " ~ idea.l_name }}</strong> says &mdash;</cite><blockquote><p>{{ idea.text|truncate(180) }}</p></blockquote></span></div>
										{% endfor %}
									</div>
								</div>
								<div class="box area3 grouping">
									<div class="hd">
										<h3>{{ d.template_data.all_ideas.data[2].title }}</h3>
									</div>
									<div class="bd">
										{% for idea in d.template_data.all_ideas.data[2].ideas %}
											<div class="small-note"><span><cite class="note-meta-hd"><strong>{{ idea.f_name ~ " " ~ idea.l_name }}</strong> says &mdash;</cite><blockquote><p>{{ idea.text|truncate(180) }}</p></blockquote></span></div>
										{% endfor %}
									</div>
								</div>
								<div class="box area4 grouping">
									<div class="hd">
										<h3>{{ d.template_data.all_ideas.data[3].title }}</h3>
									</div>
									<div class="bd">
										{% for idea in d.template_data.all_ideas.data[3].ideas %}
											<div class="small-note"><span><cite class="note-meta-hd"><strong>{{ idea.f_name ~ " " ~ idea.l_name }}</strong> says &mdash;</cite><blockquote><p>{{ idea.text|truncate(180) }}</p></blockquote></span></div>
										{% endfor %}
									</div>
								</div>
								<div class="box area5 grouping">
									<div class="hd">
										<h3>{{ d.template_data.all_ideas.data[4].title }}</h3>
									</div>
									<div class="bd">
										{% for idea in d.template_data.all_ideas.data[4].ideas %}
											<div class="small-note"><span><cite class="note-meta-hd"><strong>{{ idea.f_name ~ " " ~ idea.l_name }}</strong> says &mdash;</cite><blockquote><p>{{ idea.text|truncate(180) }}</p></blockquote></span></div>
										{% endfor %}
									</div>
								</div>
							</div>
						</div>
					</div>
				
				</div><!--end .splash-inner-->
				
				<div class="splash-inner">
					<!-- after idea is posted step -->
				
					<div class="top-pane related-processing step-three">
						<div class="console">
							<span class="console-message">
								Go from an idea to a solution: join or start a project.
							</span>
						</div>
					</div>
				
					<div class="projects-pane step-three found">
						<div class="box related-projects">
							<div class="hd">
								<h2>Related Projects <!-- <em>near</em> <span class="serif"><strong></strong></span> --></h2>
							</div>
							<div class="bd">
								<ul class="projects-list">
								</ul>
								<a href="/search" class="see-more">See more projects <em>near</em> you &rarr;</a>
							</div>
						</div>
						<div class="box citywide-projects">
							<div class="hd">
								<h2>Citywide Projects</h2>
							</div>
							<div class="bd">
								<ul class="projects-list">
								</ul>
								<a href="/search" class="see-more">See more citywide projects &rarr;</a>
							</div>
						</div>
						<div class="controls">
							<a href="/search#projects" class="rounded-button">Browse All</a><span>or</span><a href="/create" class="rounded-button">Start Your Own</a>
						</div>
					</div>
				
				
					<div class="projects-pane not-found" >
						<div class="box no-related-projects">
							<div class="hd">
								<h2>No related projects found!</h2>
								<p>We may have something for you but we couldn't find anything based on your idea or its location.</p>
							</div>
							<div class="bd">
								<div class="row clearfix">
									<p>This may be a good sign that you should start your own project:</p>
									<a href="/create" class="rounded-button">Start Your Own</a>
								</div>
								<div class="row clearfix">
									<p class="center"><em>or</em></p>
								</div>
								<div class="row clearfix">
									<p>Search for an existing project that may interest you:</p>
									<a href="/search#projects" class="rounded-button">Browse All</a>
								</div>
							</div>
						</div>
					</div>
				
				
				</div><!--end .splash-inner-->

			</div><!--end .splash-->
			
			<div class="note-card-pane">
				<div class="membrane">
					<div class="note-card-splash">
						<cite class="note-meta-hd">
							<strong>You</strong> said &mdash;
						</cite>
						<blockquote>
							<p>More Trees in New York City would be awesome and it would totally help to make it way more green! Let's plant some!</p>
						</blockquote>
					</div>
				</div>
			</div>
				
		</div><!--end .splash-container-->
		
		<div class="social-networking">
			<div class="facebook"><iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.giveaminute.info&amp;layout=standard&amp;show_faces=false&amp;width=600&amp;action=like&amp;font=verdana&amp;colorscheme=light&amp;height=25" scrolling="no" frameborder="0" style="border:none; overflow:hidden; height:25px; width: 600px;" allowTransparency="true"></iframe></div>
		</div>
	</div>

	<div class='midlands clearfix'>
		<div class="west">
			<div>
				<h1><strong>Give a Minute</strong> is a way to get your ideas heard, build projects, and change your city.</h1>
			</div>
			
			<div class="box whos-listening">
				<div class="hd">
					<a name="whos-listening"></a>
					<h2>Who's listening?</h2>
					<p>Give a Minute's network of leaders regularly review ideas, endorse groups, and communicate with members.</p>
				</div>
				<div class="bd">
					<ul class="">
						<li>
							<img src="/static/images/thumb_mbloomberg.jpg" alt="" width="106" height="80" />
							<p class="name">Michael Bloomberg</p>
							<p class="job">Mayor</p>
						</li>
						<li>
							<img src="/static/images/thumb_sgoldsmith.jpg" alt="" width="106" height="80" />
							<p class="name">Steve Goldsmith</p>
							<p class="job">Deputy Mayor</p>
						</li>
						<li>
							<img src="/static/images/thumb_pshepard.jpg" alt="" width="106" height="80" />
							<p class="name">Peggy Shepard</p>
							<p class="job">West Harlem Environ. Action Coalition</p>
						</li>
						<li class="every-fourth">
							<img src="/static/images/thumb_ryaro.jpg" alt="" width="106" height="80" />
							<p class="name">Robert Yaro</p>
							<p class="job">Regional Plan Assoc.</p>
						</li>
						<li>
							<img src="/static/images/thumb_eyeampierre.jpg" alt="" width="106" height="80" />
							<p class="name">Elizabeth Yeampierre</p>
							<p class="job">Executive Director, UPROSE</p>
						</li>
						<li>
							<img src="/static/images/thumb_akeys.jpg" alt="" width="106" height="80" />
							<p class="name">Alicia Keys</p>
							<p class="job">Musician</p>
						</li>
						<li>
							<img src="/static/images/thumb_agrenier.jpg" alt="" width="106" height="80" />
							<p class="name">Adrian Grenier</p>
							<p class="job">Actor</p>
						</li>
						<li class="every-fourth">
							<img src="/static/images/thumb_dbryne.jpg" alt="" width="106" height="80" />
							<p class="name">David Byrne</p>
							<p class="job">Musician</p>
						</li>
					</ul>
				</div>
			</div>
		</div>
		<div class="east">
			<div class="box why-use">
				<div class="hd">
					<h2>Why use Give a Minute?</h2>
				</div>
				<div class="bd">
					<ol class=" ">
						<li>
							<span class="num"><span>1</span></span>
							<span class="text">Access a limited number of &#36;5,000 starter grants for <a href="/search#projects">Projects</a></span>
						</li>
						<li>
							<span class="num"><span>2</span></span>
							<span class="text">Communicate with private and public sector leaders</span>
						</li>
						<li>
							<span class="num"><span>3</span></span>
							<span class="text">Discover and connect with relevant <a href="/search#resources">city resources</a></span>
						</li>
					</ol>
				</div>
			</div>
			<div class="box whats-happening">
				<div class="hd">
					<h2>What's happening?</h2>
				</div>
				<div class="bd">
					<ul class="news-stack">
						<li>
							<cite class="meta">02.03.2011</cite>
							<h3>New grants program announced!</h3>
							<p>The city is happy to announce a new grant program of up to &#36;4000 for innovative ideas that transform neighborhoods.</p>
						</li>
						<li>
							<cite class="meta">02.20.2011</cite>
							<h3>Give a Minute generates new ideas for New York City in 2011</h3>
							<p>The city is happy to announce that it received thousands of ideas this year!</p>
						</li>
					</ul>
				</div>
				<div class="ft">
					<a class="read-more" href="/blog">Read more news &rarr;</a>
				</div>
			</div>
		</div>
	</div>

	<div class='foothills'>

	</div>
	
	<div class='modal-content toc'>
		<h2><strong>Terms and Conditions</strong></h2>
		<div class="scroll-pane">
			{% include 'partials/toc.html' %}
		</div>
		<a class='close' href="#"><span>close</span></a>
	</div>
	
	<li class='template-content project-item'>
		<div class="thumb">
			<img src="http://placehold.it/50x50" alt="" class="proj"/>
			<span class="overlay-tag"></span>
			<span class="member-count">58</span>
		</div>
		<div class="project-info">
			<div class="endorser-thumb clearfix" style='display:none;'>
				<img src="http://placehold.it/30x30" alt="" class="endorser-photo" />
				<span class="overlay-tag"></span>
			</div>
			<span class="link"><a href="/project">Plant a Million Trees</a></span>
			<span class="creator"><em>Created by </em> Terry Richardson<br /><em>from </em> <strong>MillionTreesNYC</strong></span>
			<span class="description">Tired of the empty lot at 161st and Melrose? Let&rsquo;s start a garden...</span>
		</div>
	</li>
	
</div>
{% endblock continent %}

{% block page_js %}
<script>
	app_page.features.push(function(app){
		tc.util.log('Give A Minute: HOME');
		
		tc.jQ('a.toc-link').bind('click',{
			app:app,
			source_element:tc.jQ('.modal-content.toc'),
			init:function(modal,callback){
				if(tc.jQ.isFunction(callback)){
					callback(modal);
				}
			}
		},function(e,d){
			e.preventDefault();
			e.data.app.components.modal.show(e.data);
		});
		
		app.components.merlin = new tc.merlin(app,{
			dom:tc.jQ('.splash.merlin'),
			progress_element:tc.jQ('.merlin-progress'),
			next_button:tc.jQ('.primary-action .ca-btn'),
			error_indicator:tc.jQ('.oops'),
			watch_keypress:true,
			first_step:'start',
			data:{
				text:null,
				email:null,
				location_id:null
			},
			steps:{
				'start':{
					prev_step:null,
					next_step:'idea-details',
					selector:'.step-one',
					inputs:{
						idea:{
							selector:'textarea.idea',
							validators:['min-3','max-200','required'],
							hint:'',
							focus_first:true
						}
					},
					finish:function(merlin,dom){
						merlin.options.data = tc.jQ.extend(merlin.options.data,{
							text:merlin.current_step.inputs.idea.dom.val()
						});
					}
				},
				'idea-details':{
					prev_step:'start',
					next_step:'idea-processing',
					selector:'.step-two',
					inputs:{
						email:{
							selector:'input.email',
							validators:['min-3','max-200','required','email'],
							hint:'',
							focus_first:true
						},
						location:{
							selector:'.location-group',
							validators:tc.locationDropdown.validator
						}
					},
					step_data:{},
					transition:function(merlin,dom){
						var elements = {
							pane:merlin.dom.find('.top-pane'),
							idea_input:merlin.dom.find('.idea-input-inner-wrapper'),
							cons:merlin.dom.find('.console'),
							start:merlin.dom.find('.step-one'),
							two:merlin.dom.find('.info-input')
						};
						elements.idea_input.css('height','93.2px').animate({
							width:'0px',
							opacity:0
						},400,'easeOutCubic',function(){
							tc.jQ(this).hide();
							elements.cons.css('width','775px').children('.more-info').show().siblings().hide();
							animate_bg(elements.pane,5,7.5);
							elements.two.css('height','0px').css('opacity',0).show().delay(200).animate({
								opacity:1.0,
								height:'142px'
							},400,'easeOutCubic',function(){
								
							});
						});
						
					},
					init:function(merlin,dom){
						if(!merlin.current_step.step_data.locationDropdown){
							merlin.current_step.step_data.locationDropdown = new tc.locationDropdown({
								radios:dom.find('input[type=radio]'),
								input:dom.find('input.location-hood-enter'),
								list:dom.find('div.location-hood-list'),
								warning:dom.find('span.error'),
								locations:merlin.app.app_page.data.locations
							});
						}
					},
					finish:function(merlin,dom){
						merlin.options.data = tc.jQ.extend(merlin.options.data,{
							email:merlin.current_step.inputs.email.dom.val(),
							location_id:merlin.current_step.step_data.locationDropdown.getLocation()
						});
					}
				},
				'idea-processing':{
					prev_step:'idea-details',
					next_step:'related',
					selector:'.idea-processing',
					transition:function(merlin,dom){},
					init:function(merlin,dom){
						tc.jQ.ajax({
							type:'POST',
							url:'/idea',
							data:merlin.options.data,
							context:merlin,
							dataType:'text',
							success:function(data,ts,xhr){
								if(data == 'False'){
									return false;
								}
								this.options.data.idea_id = data;
								this.dom.siblings('.note-card-pane').find('strong').text('You');
								this.dom.siblings('.note-card-pane').find('blockquote').html('<p>'+merlin.options.data.text+'</p>');
								window.location.hash = 'related-processing';
							}
						});
					}
				},
				'related-processing':{
					prev_step:'idea-details',
					next_step:null,
					//selector:'.related-processing',
					transition:function(merlin,dom){
						merlin.dom.find('.grouping').hide();
						var elements = {
							hey:merlin.dom.parent().siblings('.hey'),
							note:merlin.dom.siblings('.note-card-pane'),
							bkg:merlin.dom.siblings('.splash-background')
						};
						elements.hey.animate({
							top:'-110px'
						},1000,'easeOutCubic');
						elements.bkg.animate({
							marginLeft:'-300px'
						},1400,'easeInOutQuad');
						merlin.dom.animate({
							marginLeft:'-1260px'
						}, 1400,"easeInOutCubic",function(){
							window.location.hash = 'related-processing-2';
						});
						elements.note.css('zIndex',10000).delay(300).animate({
							width:'366px',
							height:'609px'
						},1000,'easeOutCubic');
					}
				},
				'related-processing-2':{
					prev_step:'idea-details',
					next_step:null,
					selector:'.related-processing',
					init:function(merlin,dom){
						tc.jQ.ajax({
							url:'/idea/related',
							data:merlin.options.data,
							context:merlin,
							dataType:'json',
							success:function(data,ts,xhr){
								if(data.citywide.length || data.related.length){
									this.options.steps['related'].step_data = data;
									window.location.hash = 'related';
								} else {
									window.location.hash = 'related-not-found';
								}
							}
						});
					}
				},
				'related':{
					prev_step:'idea-details',
					next_step:null,
					selector:'.step-three',
					init:function(merlin,dom){
						var i, temphtml;
						
						if(merlin.current_step.step_data){
							if(!merlin.current_step.step_data.related.length){
								dom.find('.related-projects').hide();
								dom.find('.citywide-projects').addClass('single');
							} else {
								for(i in merlin.current_step.step_data.related){
									if(i == 2){ break; }
									//dom.find('.related-projects').find('.serif').html("<strong>"++"</strong>")
									temphtml = tc.jQ('.template-content.project-item').clone().removeClass('template-content');
									temphtml.find('.link a').text(merlin.current_step.step_data.related[i].title);
									temphtml.find('.creator').html('<span class="creator"><em>Created by </em> XXXXXX XXXXXXXX</span>');
									temphtml.find('.description').text(merlin.current_step.step_data.related[i].description);
									temphtml.find('.member-count').text(merlin.current_step.step_data.related[i].num_members);
									if(merlin.current_step.step_data.related[i].endorsement){
										temphtml.find('.endorser-thumb').show();
									}
									dom.find('.related-projects').find('ul').append(temphtml);
								}
								dom.find('.related-projects').css('opacity',0.0).show().animate({
									opacity:1.0
								},1000,'easeOutCubic');
							}
							if(!merlin.current_step.step_data.citywide.length){
								dom.find('.citywide-projects').hide();
								dom.find('.related-projects').addClass('single');
							} else {
								for(i in merlin.current_step.step_data.citywide){
									if(i == 2){ break; }
									temphtml = tc.jQ('.template-content.project-item').clone().removeClass('template-content');
									temphtml.find('.link a').text(merlin.current_step.step_data.citywide[i].title);
									temphtml.find('.creator').html('<span class="creator"><em>Created by </em> XXXXXX XXXXXXXX</span>');
									temphtml.find('.description').text(merlin.current_step.step_data.citywide[i].description);
									temphtml.find('.member-count').text(merlin.current_step.step_data.citywide[i].num_members);
									if(merlin.current_step.step_data.citywide[i].endorsement){
										temphtml.find('.endorser-thumb').show();
									}
									dom.find('.citywide-projects').find('ul').append(temphtml);
								}
								dom.find('.citywide-projects').css('opacity',0.0).show().animate({
									opacity:1.0
								},1000,'easeOutCubic');
							}
							
						}
					}
				},
				'related-not-found':{
					prev_step:'idea-details',
					next_step:null,
					selector:'.step-three',
					init:function(merlin,dom){
						
					}
				}
			}
		});
		
		var note_source = {{ d.all_ideas }};
		
		
		//generateAndArrangeNotes(1);
		
		arrangeNotes("1");
		arrangeNotes("2");
		arrangeNotes("3");
		arrangeNotes("4");
		arrangeNotes("5");
		
		function generateAndArrangeNotes(area_index){
			//settings
			var gridDistance = 46; // in pixels
			var maxOffset = 15; // in pixels
			
			// selectors
			var areaSelector = ".area"+areaNum;
			var theArea = $(areaSelector);
			var smallNote = $(areaSelector+' .small-note');
			
			// initial values
			var positionX = 0 - gridDistance;
			var positionY = 0;
			var rowCount = 0;
			
			var maxX = theArea.width() - 45;
			var maxY = theArea.height() - theArea.children('.hd').height() - 46;
			var noteColorId = areaNum;
						
			for(var i = 0; i < smallNote.length; i++) {
				// set initial position according to gridDistance
				positionX = positionX + gridDistance;
				if (positionX > maxX) { 
					if (rowCount%2 == 0) { positionX = gridDistance / 2 } 
					else { positionX = 0 - gridDistance };
					positionY = positionY + (gridDistance / 2);
					rowCount++;
				};
				
				// z-index & new position
				var posOrNegOffset = 1;
				var randomZindex = Math.floor(Math.random()*(100)) + 5;
				var newX = positionX + (Math.floor(Math.random()*maxOffset) * posOrNegOffset);
				var newY = positionY + (Math.floor(Math.random()*maxOffset) * posOrNegOffset);
				
				// randomly place note if it falls out-of-bounds
				if (newX > maxX || newX < 0) { newX = Math.floor(Math.random()*(maxX + 1)); }
				if (newY > maxY || newY < 0) { newY = Math.floor(Math.random()*(maxY + 1)); }
			
				// background image
				var bgImageName;
				var bgImageCounter = i%5;
				if (bgImageCounter==0) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"a.png)"}
				else if (bgImageCounter==1) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"b.png)"}
				else if (bgImageCounter==2) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"c.png)"}
				else if (bgImageCounter==3) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"d.png)"}
				else {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"e.png)"};
				
				// set style
				smallNote.eq(i).css({/*'display' : 'block', */'top' : newY, 'left' : newX, 'zIndex' : randomZindex, 'backgroundImage' : bgImageName});			
			};
			
			smallNote.fadeIn(2000);
			
		}
		
		// .small-note arrange
		function arrangeNotes(areaNum) {
			//settings
			var gridDistance = 46; // in pixels
			var maxOffset = 15; // in pixels
			
			// selectors
			var areaSelector = ".area"+areaNum;
			var theArea = $(areaSelector);
			var smallNote = $(areaSelector+' .small-note');
			
			// initial values
			var positionX = 0 - gridDistance;
			var positionY = 0;
			var rowCount = 0;
			
			var maxX = theArea.width() - 45;
			var maxY = theArea.height() - theArea.children('.hd').height() - 46;
			var noteColorId = areaNum;
						
			for(var i = 0; i < smallNote.length; i++) {
				// set initial position according to gridDistance
				positionX = positionX + gridDistance;
				if (positionX > maxX) { 
					if (rowCount%2 == 0) { positionX = gridDistance / 2 } 
					else { positionX = 0 - gridDistance };
					positionY = positionY + (gridDistance / 2);
					rowCount++;
				};
				
				// z-index & new position
				var posOrNegOffset = 1;
				var randomZindex = Math.floor(Math.random()*(100)) + 5;
				var newX = positionX + (Math.floor(Math.random()*maxOffset) * posOrNegOffset);
				var newY = positionY + (Math.floor(Math.random()*maxOffset) * posOrNegOffset);
				
				// randomly place note if it falls out-of-bounds
				if (newX > maxX || newX < 0) { newX = Math.floor(Math.random()*(maxX + 1)); }
				if (newY > maxY || newY < 0) { newY = Math.floor(Math.random()*(maxY + 1)); }
			
				// background image
				var bgImageName;
				var bgImageCounter = i%5;
				if (bgImageCounter==0) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"a.png)"}
				else if (bgImageCounter==1) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"b.png)"}
				else if (bgImageCounter==2) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"c.png)"}
				else if (bgImageCounter==3) {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"d.png)"}
				else {bgImageName = "url(/static/images/small-notes/note-bg-"+noteColorId+"e.png)"};
				
				// set style
				smallNote.eq(i).css({'display' : 'block', 'top' : newY, 'left' : newX, 'zIndex' : randomZindex, 'backgroundImage' : bgImageName});			
			};
		};
		

		
		// .small-note hover
		var hoverZindexCounter = 106;
		bigNoteCardSelector = $(".note-card-splash");
		$(".small-note").hover(
			function () {
				$(this).css({'zIndex' : hoverZindexCounter});
				var theContents = $(this).children('span').html();
				bigNoteCardSelector.stop(true, true).fadeOut(50);
				bigNoteCardSelector.html( theContents ).fadeIn(150);
			},
			function () {
				hoverZindexCounter++;
			}
		); 

	});
</script>
{% endblock page_js %}