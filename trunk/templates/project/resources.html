<div class="box resources">
	<div class="hd clearfix">
		<h2>
			<span>
				Resources
			</span>
		</h2>
	</div>

	<div class="bd">
		<p class="hint">The resources listed below are separate entities not run by the Give a Minute Projects but used by this Project</p>
		
		<!-- begin .external-links -->
		<div class="external-links">
			<div class="sub-hd">
				<h3>External Links</h3>
			</div>
			
			<div class="sub-bd" style="{% if d.template_data.project.data.info.resources.links['items']|length == 0 %}display:none;{% endif %}">
				<table class="resources-list doublewide">
					<tbody>
						{% for link in d.template_data.project.data.info.resources.links['items'] %}
							{% if loop.index is odd %}
								<tr>
							{% endif %}
							<td rel="#link,{{ link.link_id }}" title="{{ link.title }}">
								<span class="thumb">
									<img src="http://placehold.it/30x30" alt=""/>
								</span>
								<span class="resource-name">
									<span>
										<span><a href="{{ link.url }}"><span>{{ link.title }}</span></a></span>
									</span>
								</span>
							</td>
							{% if loop.index is even %}
								</tr>
							{% endif %}
						{% endfor %}
					</tbody>
				</table>
			</div>
			
			<div class="sub-ft clearfix" style="{% if d.template_data.project.data.info.resources.links['items']|length == 0 %}display:none;{% endif %}">
				<a href="#" class="rounded-button small add-link">Add a Link</a>
			</div>
			
			<div class="sub-bd" style="{% if d.template_data.project.data.info.resources.links['items']|length > 0 %}display:none;{% endif %}">
				<div class="empty-state-box">
					<!-- <a class="close" href="#"><span>Close</span></a> -->
					<p><a href="#show,link_add">Add links</a> to anything, including some of our recommended links like Facebook groups and Kickstarter.</p>
					<a href="#show,link_add" class='rounded-button small add-link'>Add Link</a>
				</div>
			</div>
		</div>
		<!-- end .external-links -->
		
		<!-- begin .organizations -->
		<div class="organizations">
			<div class="sub-hd">
				<h3>Organizations</h3>
			</div>
			
			<div class="sub-bd" style="{% if d.template_data.project.data.info.resources.organizations['items']|length == 0 %}display:none;{% endif %}">
				<table class="resources-list doublewide">
					<tbody>
						{% for org in d.template_data.project.data.info.resources.organizations['items'] %}
							{% if loop.index is odd %}
								<tr>
							{% endif %}
							<td rel="#organization,{{ org.organization }}" title="{{ org.title }}">
								<span class="thumb">
									<img src="http://placehold.it/30x30" alt=""/>
								</span>
								<span class="resource-name">
									<span>
										<span><a href="{{ org.url }}" class='tooltip_trigger'><span>{{ org.title }}</span></a></span>
									</span>
								</span>
							</td>
							{% if loop.index is even %}
								</tr>
							{% endif %}
						{% endfor %}
					</tbody>
				</table>
			</div>
				
			<div class="sub-ft clearfix" style="{% if d.template_data.project.data.info.resources.organizations['items']|length == 0 %}display:none;{% endif %}">
				<a href="#show,related_resources" class="rounded-button small add-organization">Add Organization</a>
			</div>
			
			<div class="sub-bd" style="{% if d.template_data.project.data.info.resources.organizations['items']|length > 0 %}display:none;{% endif %}">
				<div class="empty-state-box">
					<!-- <a class="close" href="#"><span>Close</span></a> -->
					<p>When you <a href="#show,related_resources">add organizations</a>, we'll introduce your project to the people over there.</p>
					<a href="#show,related_resources" class="rounded-button small">Add Organizations</a>
				</div>
			</div>
			
		</div>
		<!-- end .organizations -->
		
	</div>
</div>

<div class='tooltip' id='tooltip' style='display:none;position:absolute;'></div>

<div class='template-markup' id='organization-markup-source' style='display:none;'>
	<div class='tooltip-hd'>
		<h2></h2>
	</div>
	<div class='tooltip-bd'>
		<div class='info'>
			<div class='thumb'>
				<img alt='' src='http://placehold.it/90x90'/>
			</div>
			<div class='main'>
				<p></p>
			</div>
		</div>
		<dl class='details'>
			<dt>Visit Us</dt>
			<dd><a href=''></a></dd>
		</dl>
	</div>
</div>

<script>
	if(!tc){ var tc = {}; }
	if(!tc.gam){ tc.gam = {}; }
	if(!tc.gam.project_widgets){ tc.gam.project_widgets = {}; }
	
	tc.gam.project_widgets.resources = function(project,dom,deps,options){
		var widget, me;
		tc.util.log("project.resources");
		me = this;
		this.options = tc.jQ.extend({name:'resources'},options);
		this.dom = dom; 
		widget = tc.gam.widget(this,project);
		this.handlers = {
			add_link: function(e, d) {
				e.preventDefault();
				//TODO
			},
			add_organization: function(e, d) {
				e.preventDefault();
				e.data.project.components.related_resources.show(true);
			}
		};
		
		tc.resource_tooltip({
			triggers: this.dom.find(".resources-list .tooltip_trigger"),
			tooltip_element:tc.jQ('#tooltip'),
			markup_source_element:tc.jQ('#organization-markup-source'),
			get_url: "/project/resource/info"
		});
		
		//this.dom.find("a.add-link").bind('click',{ project:project,me:this },this.handlers.add_link);
		this.dom.find("a.add-organization").bind('click',{ project:project,me:this },this.handlers.add_organization);
		return {
			show:widget.show,
			hide:widget.hide
		};
	};

	
</script>